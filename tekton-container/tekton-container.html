<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">

<link rel="import" href="../tekton-login/tekton-login.html">
<link rel="import" href="../tekton-admin/tekton-admin.html">
<link rel="import" href="../tekton-user/tekton-user.html">
<link rel="import" href="../tekton-universe-selector/tekton-universe-selector.html">
<link rel="import" href="../tekton-vendor-selector/tekton-vendor-selector.html">
<link rel="import" href="../tekton-ad-selector/tekton-ad-selector.html">
<link rel="import" href="../tekton-ad-creator/tekton-ad-creator.html">
<link rel="import" href="../tekton-ad-manager/tekton-ad-manager.html">

<dom-module id="tekton-container">
    <template>
        <style>
            #container {
                border: 1px solid #ffffff;
    		border-radius: 1px;
    		background: white;
    		height: 350px;
    		width: 600px;
    		position: relative;
    		box-shadow: 2px 2px 20px lightslategrey;
            }

            #signOut {
                border: 1px #adadad solid;
    		border-radius: 3px;
    		background: white;
    		width: 120px;
    		position: absolute;
    		right: 5px;
    		top: 11px;
		color: #525252;
            }

            #back {
    		border: 1px #adadad solid;
    		border-radius: 3px;
    		background: white;
    		width: 60px;
    		height: 40px;
    		min-width: 1em;
    		position: absolute;
    		left: 5px;
    		top: 11px;
    		font-size: 20px;
    		color: #525252;
            }

            #done {
                position: relative;
                top: 150px;
                left: 300px;
            }

            #submitted {
                position: relative;
                top: 190px;
                left: 165px;
            }

        </style>

        <div id="container">
            <template is="dom-if" if="[[canSignOut]]">
                <paper-button id = "signOut" on-tap="signOut">Sign Out</paper-button>
            </template>

            <iron-pages id="pages" selected="0">
                <tekton-login id = "login"></tekton-login>
                <tekton-admin id = "admin"></tekton-admin>
                <tekton-user id = "user"></tekton-user>
                <tekton-universe-selector id="universeSelector" universes="[[universes]]"></tekton-universe-selector>
                <tekton-vendor-selector id="vendorSelector"></tekton-vendor-selector>
                <tekton-ad-selector id="adSelector"></tekton-ad-selector>
                <tekton-ad-creator id="adCreator"></tekton-ad-creator>
                <tekton-ad-manager id="adManager"></tekton-ad-manager>
                <div id="finished">
                    <b id="done">Done!</b>
                    <b id="submitted">Universe submitted to Facebook.</b>
                </div>
            </iron-pages>

            <template is="dom-if" if="[[canGoBack]]">
                <paper-button id="back" on-tap="goBack">Â«</paper-button>
            </template>

        </div>
    </template>

    <script>
        Polymer({
            is: "tekton-container",

            properties: {
                canSignOut: {
                    type: Boolean,
                    notify: false,
                    value: false
                },

                canGoBack: {
                    type: Boolean,
                    notify: false,
                    value: false
                },
				universes: {
                    type: Array,
                    notify: false,
                    value: [{"name": "Universe #1","pdi_id": "251234213"},
                            {"name": "Universe #2","pdi_id": "748192948"},
                            {"name": "Universe #3","pdi_id": "021952354"},
                            {"name": "Universe #4","pdi_id": "846182023"},
                            {"name": "Universe #5","pdi_id": "128743844"},
                            {"name": "Universe #6","pdi_id": "857483947"},
                            {"name": "Universe #7","pdi_id": "231758212"},
                            {"name": "Universe #8","pdi_id": "859321473"},
                            {"name": "Universe #9","pdi_id": "428834341"},
                            {"name": "Universe #10","pdi_id": "215214642"}]
                },
				selectedUniverse: {
					type: String,
					notify: false,
					value: "none"
				},
				userFBAccountAccessToken: {
					type: Array,
					notify: true,
					value: "none"
				},
				userFBAccountID: {
					type: String,
					notify: true,
					value: "none"
				},
				userFBAdAccountID: {
					type: String,
					notify: true,
					value: "none"
				},
				//FIXME - this is a sandbox account test token, how / where do we get this token from actual accounts?
				userAdAccountAccessToken: {
					type: Array,
					notify: true,
					value: "EAADxoAuZBQREBAPVbt0rw8ZCKrKUMzZAhCjYqBxTi27ONyCtllWvxGD8GZBrKPQNrLGGtnNsr8J6ZClCI6Orw2q4hg6WuZC5AtVx7LT9aSCIe80OteDZC8H03ZCtDdIKm5Qdiu6Oi485SLD5jjgCYujokOeqBpwuvff9zumGnU8BWRLq6bxF6DBRWQDkOnZBde8AenobJsbkAK3jK8TAEeEARDVYRN7a6WtkZD"
				}



				//TODO: add in all state variables
            },

            listeners: {
                'admin-signed-in': 'toggleLogin',
                'user-signed-in': 'toggleUser',
                'universe-selector-tapped': 'toggleUniverseSelector',
                'back-user-tapped': 'toggleUser',
                'next-tapped': 'toggleVendorSelector',
                'logo-tapped': 'toggleAdSelector',
                'submit-tapped': 'toggleFinished',
                'create-ad-tapped': 'toggleCreateAd',
                'ad-creator-button-tapped': 'toggleAdSelector',
                'manage-ads-tapped': 'toggleAdManager',
                'sign-out-tapped': 'signOut'
            },

            toggleLogin: function() {
                this.$$('#pages').selected = "1";
                this.canSignOut = true;
                this.canGoBack = false;
            },

            toggleUser: function() {
                this.$$('#pages').selected = "2";
                this.canSignOut = true;
                this.canGoBack = false;
            },

            toggleUniverseSelector: function() {
                this.$$('#pages').selected = "3";
                this.canSignOut = true;
                this.canGoBack = true;
            },

            toggleVendorSelector: function() {
                this.$$('#pages').selected = "4";
                this.canSignOut = true;
                this.canGoBack = true;
            },

            toggleAdSelector: function() {
                this.$$('#pages').selected = "5";
                this.canSignOut = true;
                this.canGoBack = true;
            },

            toggleCreateAd: function() {
                this.$$('#pages').selected = "6";
                this.canSignOut = true;
                this.canGoBack = false;
            },

            toggleAdManager: function() {
                this.$$('#pages').selected = "7";
                this.canSignOut = true;
                this.canGoBack = true;
            },

            toggleFinished: function() {
                this.$$('#pages').selected = "8";
                this.canSignOut = true;
                this.canGoBack = true;
            },

            goBack: function() {
                var page = this.$$('#pages').selected;

                if (page === "3" || page === "7" || page === "8") {
                    this.$$('#pages').selected = "2";
                    this.canGoBack = false;
                } else if (page === "4") {
                    this.$$('#pages').selected = "3";
                } else if (page === "5") {
                    this.$$('#pages').selected = "4";
                }

            },

            signOut: function() {
                this.$$('#pages').selected = "0";
                this.canSignOut = false;
                this.canGoBack = false;
            }

        });
    </script>
</dom-module>
